{% extends "base.html" %}

{% block content %}
<div class="glass-card">
    <h2 style="margin-top: 0; color: var(--deep-pink);">ğŸ›¡ï¸ è§„åˆ™ç®¡ç†</h2>

    <div style="background: rgba(255,255,255,0.4); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
        <h4>â• æ·»åŠ æ–°è§„åˆ™ (æ­£åˆ™)</h4>
        <form action="/rules/add" method="post" style="display: flex; gap: 10px; flex-wrap: wrap;">
            <select name="rule_type" style="padding: 10px; border-radius: 8px; border: 1px solid #ddd;">
                <option value="message_content">æ¶ˆæ¯å†…å®¹</option>
                <option value="username">ç”¨æˆ·å</option>
                <option value="is_command">æ˜¯å¦ä¸ºå‘½ä»¤</option>
                <option value="is_forwarded">æ˜¯å¦ä¸ºè½¬å‘</option>
            </select>
            <input type="text" name="pattern" placeholder="æ­£åˆ™æ¨¡å¼ (ä¾‹å¦‚: ^/start)" required
                style="flex: 1; padding: 10px; border-radius: 8px; border: 1px solid #ddd;">
            <select name="action" style="padding: 10px; border-radius: 8px; border: 1px solid #ddd;">
                <option value="block">æ‹¦æˆª (æç¤º)</option>
                <option value="drop">ä¸¢å¼ƒ (é™é»˜)</option>
                <option value="allow">æ”¾è¡Œ (ç™½åå•)</option>
            </select>
            <button type="submit" class="btn">æ·»åŠ </button>
        </form>
    </div>

    <div style="overflow-x: auto;">
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>ç±»å‹</th>
                    <th>æ¨¡å¼</th>
                    <th>åŠ¨ä½œ</th>
                    <th>çŠ¶æ€</th>
                    <th>æ“ä½œ</th>
                </tr>
            </thead>
            <tbody>
                {% for rule in rules %}
                <tr>
                    <td>{{ rule.id }}</td>
                    <td>{{ rule.rule_type }}</td>
                    <td><code style="background: #eee; padding: 2px 5px;">{{ rule.pattern }}</code></td>
                    <td>
                        {% if rule.action == 'block' %}<span style="color:red">æ‹¦æˆª</span>
                        {% elif rule.action == 'drop' %}<span style="color:gray">ä¸¢å¼ƒ</span>
                        {% else %}<span style="color:green">æ”¾è¡Œ</span>{% endif %}
                    </td>
                    <td>{{ "âœ…" if rule.is_active else "âŒ" }}</td>
                    <td>
                        <form action="/rules/delete" method="post" style="display:inline;">
                            <input type="hidden" name="rule_id" value="{{ rule.id }}">
                            <button type="submit" class="btn btn-danger"
                                style="padding: 5px 10px; font-size: 0.8em;">åˆ é™¤</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}